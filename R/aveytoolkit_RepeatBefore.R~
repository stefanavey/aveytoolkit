#' RepeatBefore
#'
#' Replaces NAs with the latest non-NA value
#'
#' @param x a vector of values
#' @return a vector of values 
#' @author Gavin Simpson
#' @details This function resets the graphical parameters from the par function. It flashes a new device on the screen but works to reset parameters.  Meant to be used when things get hairy and not coded in scripts
#' @keywords aveytoolkit
#' @seealso \code{\link{rep}}
#' @references  http://stackoverflow.com/questions/7735647/replacing-nas-with-latest-non-na-value
#' @export
#' @examples
#' par(oma=c(4,10,2,1))
#' plot(1,1)
#' ## paramter settings weren't saved so do a reset
#' resetPar()
#' plot(1,1)
repeat.before <- function(x) {   # repeats the last non NA value. Keeps leading NA
	        ind = which(!is.na(x))      # get positions of nonmissing values
  if(is.na(x[1	]))             # if it begins with a missing, add the
    ind = c(1,ind)        # first position to the indices
  rep(x[ind], times = diff(   # repeat the values at these indices
                c(ind, length(x) + 1) )) # diffing the indices + length yields how often
}                               # they need to be repeated




